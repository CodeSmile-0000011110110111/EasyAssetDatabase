<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>de.codesmile.editor.assetdatabase: CodeSmile AssetDatabase</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="steffen portrait codesmile logo larger top-left-64x62.png"/></td>
  <td id="projectalign">
   <div id="projectname">de.codesmile.editor.assetdatabase<span id="projectnumber">&#160;1.2</span>
   </div>
   <div id="projectbrief">Improved AssetDatabase API</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="namespace_code_smile.html">CodeSmile</a> AssetDatabase </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a> It's Unity's AssetDatabase except now it's clean, concise, consistent and powerful.</p>
<h1><a class="anchor" id="examples"></a>
Examples</h1>
<p>What used to be 20+ lines of code is now two. ;)</p>
<h2><a class="anchor" id="load-or-create-asset"></a>
Load or create asset</h2>
<p>This is the original code, a common use case from the Unity forum. Notice the extra steps involved to create the asset and the folders. </p><div class="fragment"><div class="line">public static LevelData GetLevelDataAsset(int level)</div>
<div class="line">{</div>
<div class="line">  string assetPath = &quot;Assets/DataStore/Level{level}/LevelData.asset&quot;;</div>
<div class="line"> </div>
<div class="line">  var levelData = AssetDatabase.LoadAssetAtPath&lt;LevelData&gt;(assetPath);</div>
<div class="line">  if (levelData == null)</div>
<div class="line">  {</div>
<div class="line">    // create datastore folder if not exists</div>
<div class="line">    if (!AssetDatabase.IsValidFolder(@&quot;Assets/DataStore&quot;))</div>
<div class="line">      AssetDatabase.CreateFolder(&quot;Assets&quot;, &quot;DataStore&quot;);</div>
<div class="line"> </div>
<div class="line">    // create level folder if not exists</div>
<div class="line">    if (!AssetDatabase.IsValidFolder(@&quot;Assets/DataStore/Level{level}&quot;))</div>
<div class="line">      AssetDatabase.CreateFolder(&quot;Assets/DataStore&quot;, &quot;Level{level}&quot;);</div>
<div class="line"> </div>
<div class="line">    levelData = CreateInstance&lt;LevelData&gt;();</div>
<div class="line">    AssetDatabase.CreateAsset(levelData, assetPath);</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  return levelData;</div>
<div class="line">}</div>
</div><!-- fragment --><p>With <a class="el" href="namespace_code_smile.html">CodeSmile</a> AssetDatabase the same code is just these two lines: </p><div class="fragment"><div class="line">public static LevelData GetLevelDataAsset(int level)</div>
<div class="line">{</div>
<div class="line">    string assetPath = &quot;Assets/DataStore/Level{level}/LevelData.asset&quot;;</div>
<div class="line">    return Asset.LoadOrCreate&lt;LevelData&gt;(assetPath, () =&gt; CreateInstance&lt;LevelData&gt;());</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="load-an-asset"></a>
Load an asset</h2>
<p>Easy:</p>
<p><code>Asset levelData = "Assets/Example/LevelData.asset";</code></p>
<p>Wait .. wut?? :)</p>
<p>Ah, I see, you have a GUID? In that case it's:</p>
<p><code>Asset levelData = thisIsYourGuid;</code></p>
<p>Likewise if you already have an asset object instance:</p>
<p><code>Asset levelData = yourAssetObject;</code></p>
<p>My name is <a class="el" href="namespace_code_smile.html">CodeSmile</a> for a reason. :)</p>
<h2><a class="anchor" id="get-an-assets-path"></a>
Get an asset's path</h2>
<p>Assuming you have an <code>asset</code> instance:</p>
<p><code>var assetPath = asset.AssetPath;</code></p>
<p>Oh right, you need the meta file path? Well, you could inquire the AssetDatabase:</p>
<p><code>var metaPath = AssetDatabase.GetTextMetaFilePathFromAssetPath(assetPath);</code></p>
<p>But I'd much rather have you do this:</p>
<p><code>var metaPath = asset.MetaPath;</code></p>
<p>Or if you just need to work with just paths:</p>
<div class="fragment"><div class="line">Path assetPath = &quot;Assets/Folder/LevelData.asset&quot;;</div>
<div class="line">Path metaPath = assetPath.MetaPath;</div>
</div><!-- fragment --><p>The secret sauce behind Asset.Path is that you never EVER need to worry about the path being malformed, containing illegal characters, mixing forward with backward slashes, or leaving leading/trailing slashes.</p>
<p>Asset.Path also gives access to commonly used System.IO.Path functionality:</p>
<div class="fragment"><div class="line">Path assetPath = &quot;Assets/Folder/LevelData.asset&quot;;</div>
<div class="line">Path assetDir = assetPath.DirectoryPath;</div>
<div class="line">String assetFileName = assetPath.FileName;</div>
<div class="line">String assetFileNameNoExt = assetPath.FileNameWithoutExtension;</div>
<div class="line">String assetExtension = assetPath.Extension;</div>
</div><!-- fragment --><h2><a class="anchor" id="asset-is-an-instance"></a>
Asset is an instance</h2>
<div class="fragment"><div class="line">// Create new asset of a UnityEngine.Object instance:</div>
<div class="line">Asset objAsset = new Asset(obj, &quot;Assets/Data/MySOAsset.asset&quot;);</div>
<div class="line"> </div>
<div class="line">// Load asset from an existing asset instance:</div>
<div class="line">Asset existingAsset = new Asset(obj);</div>
<div class="line">Asset existingAsset = obj; // implicit conversion</div>
<div class="line"> </div>
<div class="line">// Get the asset&#39;s path, object and guid:</div>
<div class="line">Asset.Path path = objAsset.AssetPath;</div>
<div class="line">UnityEngine.Object obj = objAsset.MainObject;</div>
<div class="line">var mySO = objAsset as MyScriptableObject; // implicit conversion + cast</div>
<div class="line">GUID guid = objAsset.Guid;</div>
<div class="line"> </div>
<div class="line">// Save modifications to the object:</div>
<div class="line">(objAsset as MyScriptableObject).BobbyBrown = &quot;My teeth is shiny!&quot;;</div>
<div class="line">objAsset.ForceSave(); // calls SetDirty on the object before saving</div>
<div class="line">// (dirty is not for Bobby but the script-only property change requires SetDirty) </div>
<div class="line"> </div>
<div class="line">// save object if it was marked dirty, otherwise skips serialization</div>
<div class="line">objAsset.Save();</div>
<div class="line"> </div>
<div class="line">// Rename the asset file:</div>
<div class="line">objAsset.Rename(&quot;different file name&quot;);</div>
<div class="line"> </div>
<div class="line">// Make a copy, will create non-existing folders:</div>
<div class="line">Asset copyAsset = objAsset.Copy(&quot;Assets/folder/subfolder/copied.asset&quot;);</div>
<div class="line"> </div>
<div class="line">// You can also move the asset to a non-existing path:</div>
<div class="line">objAsset.Move(&quot;Assets/folder/subfolder/moved.asset&quot;);</div>
<div class="line"> </div>
<div class="line">// Delete the asset file from disk: </div>
<div class="line">objAsset.Delete(); // also: objAsset.Trash()</div>
<div class="line">objAsset = null;</div>
</div><!-- fragment --><p>There's a whole lot more and it's all as simple as that PLUS extra error checking and safety. For instance, batch editing ... yeah, you know you HAVE to wrap it in try/finally but how often did you NOT do it?</p>
<p>Here it's guaranteed:</p>
<div class="fragment"><div class="line">Asset.BatchEditing(() =&gt; {</div>
<div class="line">    // your complex, mass asset editing code safely wrapped in try/finally ...</div>
<div class="line">});</div>
</div><!-- fragment --><h1><a class="anchor" id="license"></a>
License</h1>
<p>This software is licensed under the GNU General Public License v3.0 (GPL 3.0). The main implication is that any work you build using this software requires the entire work to be published under the GPL.</p>
<p>This software will also be available on the Unity Asset Store under the Asset Store EULA.</p>
<p>If you wish to license this software under different terms please contact me!</p>
<ul>
<li>Steffen aka <a class="el" href="namespace_code_smile.html">CodeSmile</a></li>
<li><a href="#" onclick="location.href='mai'+'lto:'+'ste'+'ff'+'en@'+'st'+'eff'+'en'+'itt'+'er'+'hei'+'m.'+'de'; return false;">Email</a> / <a href="https://discord.gg/JN3Jz8qkeV" target="_blank">Discord</a></li>
</ul>
<h1><a class="anchor" id="requirements"></a>
Requirements</h1>
<ul>
<li>Unity 2021.3.3f1 or newer</li>
<li>A smile :)</li>
</ul>
<h1><a class="anchor" id="installation"></a>
Installation</h1>
<p>This software is a Unity Package Manager 'npm package'.</p>
<ul>
<li>Open Window =&gt; Package Manager in Unity Editor</li>
<li>Choose "Install package from git URL..."</li>
<li>Enter this URL: <code><a href="https://github.com/CodeSmile-0000011110110111/de.codesmile.editor.assetinspector.git">https://github.com/CodeSmile-0000011110110111/de.codesmile.editor.assetinspector.git</a></code></li>
</ul>
<p>This package is currently not available on OpenUPM.</p>
<h1><a class="anchor" id="documentation"></a>
Documentation</h1>
<p><a href="https://codesmile-0000011110110111.github.io/de.codesmile.editor.assetdatabase/html/index.html" target="_blank">Manual + API Reference</a></p>
<p>tbd: spreadsheet</p>
<h1><a class="anchor" id="quick-introduction"></a>
Quick Introduction</h1>
<p>You can work either with Asset instances or the static Asset API. Internally, instance methods call the static API. The API offers both explicit and some implicit operations.</p>
<h1><a class="anchor" id="notable-changes--additions"></a>
Notable changes / additions</h1>
<h2><a class="anchor" id="assetpath"></a>
Asset.Path</h2>
<p>You may have noticed the use of the Asset.Path class. This wraps a path to an asset, ensures the path is valid, relative, uses only forward slashes (compatible with all editor platforms), has checks for file existance, methods to create the folders in a path, rename the file, and more more more ...</p>
<p>Path operations are at the heart of working with the AssetDatabase, yet it has traditionally been a crud despite a ton of utility methods because the path ultimately remained a string instance - anyone, anything could tamper it. I KNOW this happened to you too, right?</p>
<p>Paths to assets demanded a class of its own to handle all the various quirks, compatibility issues, illegal characters and just common oversights like writing an editor script on Windows that stops working on Mac/Linux due to just one single backslash.</p>
<p>The Asset.Path class implicitly converts to/from string and the conversion to Asset.Path performs validation and sanitation. So you KNOW the moment a path is malformed AND you get a readable error message.</p>
<div class="fragment"><div class="line">Asset.Path assetPath = &quot;Assets/subfolder/myfile.asset&quot;; // implicit conversion</div>
<div class="line">Asset.Path assetPath = &quot;myfile.asset&quot;; // ERROR: missing &#39;Assets&#39;</div>
<div class="line">Asset.Path assetPath = &quot;Assets/subf?lder/my|file.asset&quot;; // ERROR: illegal chars</div>
<div class="line"> </div>
<div class="line">string strPath = assetPath; // implicit conversion</div>
<div class="line"> </div>
<div class="line">strPath = &quot;C:\\Users\\Urso Clever\\Desktop\\MyPorject\\Assets\\myfile.asset&quot;;</div>
<div class="line">AssetDatabase.CreateAsset(obj, strPath); // ERROR: used an absolute path, stupid!</div>
<div class="line"> </div>
<div class="line">Asset.Create(obj, strPath); // this just works - it&#39;s magic, maaagic!</div>
</div><!-- fragment --><h2><a class="anchor" id="where-is-refresh-"></a>
Where is Refresh() ?</h2>
<p>Oh, don't get me started. Something ain't quite right? Add another AssetDatabase.Refresh(). <a href="https://forum.unity.com/threads/calling-assetdatabase-refresh-mandatory-reading-or-face-the-consequences.1330947/" target="_blank">OMG WTF!</a></p>
<p>I always wanted this method renamed. Initially I considered the true and honest name: <code>ImportAllExternallyModifiedAssetsAndUnloadUnusedAssets()</code></p>
<p>But I decided to just call it: <code>Asset.Database.ImportAll()</code></p>
<p>It is the 'many' companion to Import() the same way SaveAll() is the 'many' companion to Save(). There is no magical ' refresh'.</p>
<p>It's just a very dumb name that prompted devs to use it too often with no thought given to what it actually does. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
